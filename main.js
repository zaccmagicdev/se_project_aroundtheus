!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__input_error_visible"},t=document.querySelector("#edit-button"),s=document.querySelector(".profile__add-button"),r=document.querySelector("#profile__modal-form"),n=document.querySelector("#add-image__modal-form"),i=document.querySelector("#edit-avatar__pic-form"),o=document.querySelector("#profile-modal__input-name"),a=document.querySelector("#profile-modal__input-description"),d=document.querySelector(".profile__avatar-button");class l{constructor(e,t,s,r,n){let{name:i,link:o,id:a,isLiked:d}=e;this._name=i,this._link=o,this._id=a,this._isLiked=d,this._cardSelector=t,this._handleCardClick=s,this._handleDeleteCard=r,this._handleCardLike=n}_renderLikes(){const e=this._cardElement.querySelector(".card__like-button");this._isLiked?e.classList.add("card__like-button_clicked"):e.classList.remove("card__like-button_clicked")}_setEventListeners(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._handleCardLike()})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleDeleteCard()})),this._cardElement.querySelector("#card-image-button").addEventListener("click",(()=>{this._handleCardClick({name:this._name,link:this._link})}))}setIsLiked(e){this._isLiked=e,this._renderLikes()}isLiked(){return this._isLiked}delete(){this._cardElement.remove()}generateCard(){this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0);const e=this._cardElement.querySelector(".card__caption"),t=this._cardElement.querySelector(".card__image");return e.textContent=this._name,t.setAttribute("alt",this._name),t.setAttribute("src",this._link),this._setEventListeners(),this._renderLikes(),this._cardElement}}class c{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);t.textContent=e.validationMessage,t.classList.add(this._errorClass),e.classList.add(this._inputErrorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);t.textContent="",t.classList.remove(this._errorClass),e.classList.remove(this._inputErrorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(e){return!e.every((e=>e.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this._inputList)?this._disableButton():(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled",!0))}_disableButton(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)}_setEventListeners(){this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._buttonElement=this._form.querySelector(this._submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(t=>{t.preventDefault(),this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this._disableButton()})),this._setEventListeners()}}class h{constructor(e){this._modal=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._modal.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._modal.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._modal.querySelector(".modal__exit-button").addEventListener("click",(()=>{this.close()})),this._modal.addEventListener("mousedown",(e=>{this._modal.classList.contains("modal_opened")&&e.target===this._modal&&this.close()}))}}class _ extends h{constructor(e,t){super(e),this._modalForm=this._modal.querySelector(".modal__form"),this._modalButton=this._modal.querySelector(".modal__button"),this._modalButtonText=this._modalButton.textContent,this._modalInputs=this._modalForm.querySelectorAll(".modal__input"),this._handleFormSubmit=t}_getInputValues(){const e=new FormData(this._modalForm);return Object.fromEntries(e)}renderLoading(e){this._modalButton.textContent=e?"Saving...":this._modalButtonText}setEventListeners(){this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}close(){super.close(),this._modalForm.reset()}}const u=new class{constructor(e){this._url=e.url,this._headers=e.headers}_processResponse=e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`);async getUserData(){return fetch(this._url+"/users/me",{method:"GET",headers:this._headers}).then(this._processResponse)}async getInitialCards(){return fetch(this._url+"/cards",{method:"GET",headers:this._headers}).then(this._processResponse)}async uploadCard(e,t){return fetch(this._url+"/cards",{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._processResponse)}async deleteCard(e){return fetch(this._url+`/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._processResponse)}async getCardsAndUserData(){return Promise.all([this.getInitialCards(),this.getUserData()])}async likeCard(e){return fetch(this._url+`/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._processResponse)}async unlikeCard(e){return fetch(this._url+`/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._processResponse)}async setProfileData(e,t){return fetch(this._url+"/users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._processResponse)}async updateProfilePic(e){return fetch(this._url+"/users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._processResponse)}}({url:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a087da59-6aa1-4dbf-8a2c-982e97da6080","Content-Type":"application/json"}});u.getCardsAndUserData().then((e=>{let[t,s]=e;t.forEach((e=>{const t=y({name:e.name,link:e.link,id:e._id,isLiked:e.isLiked});k.addItem(t)}));const{avatar:r,about:n,name:i}=s;m.setUserInfo({name:i,about:n}),m.setAvatar(r)})).catch((e=>console.log(e)));const m=new class{constructor(e,t,s){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatarImage=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e){this._nameElement.textContent=e.name,this._jobElement.textContent=e.about}setAvatar(e){this._avatarImage.src=e}}("#user-name","#user-career",".profile__avatar"),p=new class extends h{constructor(e){super(e),this._modalImage=this._modal.querySelector(".modal__enlarged-image"),this._modalCaption=this._modal.querySelector(".modal__enlarged-text")}open(e,t){this._modalImage.setAttribute("src",t),this._modalImage.setAttribute("alt",e),this._modalCaption.textContent=e,super.open()}}("#enlarged-modal-box"),E=new class extends h{constructor(e){super(e),this._modalForm=this._modal.querySelector(".modal__form"),this._modalButton=this._modal.querySelector(".modal__button"),this._modalButtonText=this._modalButton.textContent}setAction(e){this._handleFormSubmit=e}renderLoading(e){this._modalButton.textContent=e?"Deleting...":this._modalButtonText}setEventListeners(){this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()})),super.setEventListeners()}}("#confirm-modal"),L=new _("#avatar-edit-modal",(e=>{L.renderLoading(!0),u.updateProfilePic(e["avatar-link"]).then((e=>{m.setAvatar(e.avatar),L.close()})).finally((()=>L.renderLoading(!1))).catch((e=>console.log(e)))})),v=new _("#add-modal-box",(e=>{v.renderLoading(!0),u.uploadCard(e["add-img-title"],e["add-img-link"]).then((e=>{const{name:t,link:s,_id:r,isLiked:n}=e;k.prependItem(y({name:t,link:s,id:r,isLiked:n})),v.close()})).finally((()=>v.renderLoading(!1))).catch((e=>console.log(e)))})),b=new _("#profile-modal-box",(e=>{b.renderLoading(!0),u.setProfileData(e["profile-modal-username"],e["profile-modal-desc"]).then((e=>{m.setUserInfo(e),b.close()})).finally((()=>b.renderLoading(!1))).catch((e=>console.log(e)))}));function y(e){const t=new l(e,"#card-template",(()=>{p.open(e.name,e.link)}),(()=>{E.open(),E.setAction((()=>{E.renderLoading(!0),u.deleteCard(t._id).then((()=>{t.delete(),E.close()})).finally((()=>E.renderLoading(!1))).catch((e=>console.log(e)))}))}),(()=>{t.isLiked()?u.unlikeCard(t._id).then((e=>t.setIsLiked(e.isLiked))).catch((e=>console.log(e))):u.likeCard(t._id).then((e=>t.setIsLiked(e.isLiked))).catch((e=>console.log(e)))}));return t.generateCard()}const k=new class{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}addItem(e){this._container.append(e)}prependItem(e){this._container.prepend(e)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}}({items:[],renderer:()=>{}},".cards");k.renderItems();const f=new c(e,n),C=new c(e,r),g=new c(e,i);f.enableValidation(),C.enableValidation(),g.enableValidation(),t.addEventListener("click",(()=>{b.open();const{name:e,job:t}=m.getUserInfo();o.value=e,a.value=t})),s.addEventListener("click",(()=>{v.open()})),d.addEventListener("click",(()=>{L.open()})),b.setEventListeners(),v.setEventListeners(),p.setEventListeners(),E.setEventListeners(),L.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VTFLLEVBQzNCUyxLQUFLa0ssT0FBU0YsRUFDZGhLLEtBQUttSyxVQUFZRixFQUVqQmpLLEtBQUtvSyxXQUFheEwsU0FBU0MsY0FBY2tMLEVBQzdDLENBRUFoQyxPQUFBQSxDQUFRc0MsR0FDSnJLLEtBQUtvSyxXQUFXRSxPQUFPRCxFQUMzQixDQUVBVCxXQUFBQSxDQUFZUyxHQUNSckssS0FBS29LLFdBQVdHLFFBQVFGLEVBQzVCLENBRUFHLFdBQUFBLEdBQ0l4SyxLQUFLa0ssT0FBTzNHLFNBQVF1RyxJQUNsQjlKLEtBQUttSyxVQUFVTCxFQUFLLEdBRTFCLEdMaUh5QixDQUN6QkUsTUFBTyxHQUNQQyxTQUFVQSxRQUNYLFVBRUhuQyxFQUFTMEMsY0FHVCxNQUFNQyxFQUFtQixJQUFJL0ksRUFBY3RELEVBQVlZLEdBQ2pEMEwsRUFBb0IsSUFBSWhKLEVBQWN0RCxFQUFZVyxHQUNsRDRMLEVBQXNCLElBQUlqSixFQUFjdEQsRUFBWWEsR0FFMUR3TCxFQUFpQi9HLG1CQUNqQmdILEVBQWtCaEgsbUJBQ2xCaUgsRUFBb0JqSCxtQkFHcEIvRSxFQUFXcUMsaUJBQWlCLFNBQVMsS0FDakM2SSxFQUFpQjFGLE9BQ2pCLE1BQU0sS0FBRXZFLEVBQUksSUFBRWtKLEdBQVFkLEVBQVNhLGNBQy9CM0osRUFBcUIwTCxNQUFRaEwsRUFDN0JULEVBQW9CeUwsTUFBUTlCLENBQUcsSUFHbkNoSyxFQUFla0MsaUJBQWlCLFNBQVMsS0FDckMySSxFQUFjeEYsTUFBTSxJQUd4Qi9FLEVBQWlCNEIsaUJBQWlCLFNBQVMsS0FDdkN3SSxFQUFnQnJGLE1BQU0sSUFHMUIwRixFQUFpQnhGLG9CQUNqQnNGLEVBQWN0RixvQkFDZDZFLEVBQWtCN0Usb0JBQ2xCZ0YsRUFBa0JoRixvQkFDbEJtRixFQUFnQm5GLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcFVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlxyXG5leHBvcnQgY29uc3QgZm9ybUNvbmZpZyA9ICh7XHJcbiAgICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICAgIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gICAgZXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfZXJyb3JfdmlzaWJsZVwiXHJcbn0pO1xyXG5cclxuZXhwb3J0IGNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZWRpdC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IGFkZEltYWdlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9maWxlX19tb2RhbC1mb3JtJyk7XHJcbmV4cG9ydCBjb25zdCBhZGRJbWFnZUVkaXRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FkZC1pbWFnZV9fbW9kYWwtZm9ybScpO1xyXG5leHBvcnQgY29uc3QgZWRpdEF2YXRhckZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZWRpdC1hdmF0YXJfX3BpYy1mb3JtJyk7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdE5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9maWxlLW1vZGFsX19pbnB1dC1uYW1lJyk7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEpvYklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2ZpbGUtbW9kYWxfX2lucHV0LWRlc2NyaXB0aW9uJyk7XHJcbmV4cG9ydCBjb25zdCBlZGl0QXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhci1idXR0b24nKTtcclxuIiwiXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gICAgY29uc3RydWN0b3IoeyBuYW1lLCBsaW5rLCBpZCwgaXNMaWtlZCB9LCBjYXJkU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlQ2FyZERlbGV0ZSwgaGFuZGxlQ2FyZExpa2UpIHtcclxuICAgICAgICB0aGlzLl9uYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLl9saW5rID0gbGluaztcclxuICAgICAgICB0aGlzLl9pZCA9IGlkO1xyXG4gICAgICAgIHRoaXMuX2lzTGlrZWQgPSBpc0xpa2VkO1xyXG4gICAgICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZUNhcmREZWxldGU7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZExpa2UgPSBoYW5kbGVDYXJkTGlrZTtcclxuICAgIH1cclxuXHJcbiAgICBfcmVuZGVyTGlrZXMoKSB7XHJcbiAgICAgICAgY29uc3QgbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgICAgICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgICAgICAgbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fY2xpY2tlZFwiKVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2NsaWNrZWRcIilcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcclxuICAgICAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSgpXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIilcclxuICAgICAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKClcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1pbWFnZS1idXR0b25cIilcclxuICAgICAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7IHRoaXMuX2hhbmRsZUNhcmRDbGljayh7IG5hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmsgfSkgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0SXNMaWtlZChpc0xpa2VkKSB7XHJcbiAgICAgICAgdGhpcy5faXNMaWtlZCA9IGlzTGlrZWQ7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICBpc0xpa2VkKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pc0xpa2VkO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZSgpIHtcclxuICAgICAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgICAgIC8vdGhpcyBpcyB3aGVyZSBpdCBnZXRzIGEgbGl0dGxlIGJpdCB0cmlja3kuLndlIG5lZWQgdG8gc2VsZWN0IG91ciBhcHByb3ByaWF0ZSBlbGVtZW50cyBhbmQgZmllbGRzIHRoZW4gcmV0dXJuIGEgY2FyZCBvYmplY3RcclxuICAgICAgICAvL3RoaXMgaXMgYWxzbyBnb2luZyB0byBiZSB3aGVyZSB3ZSBjYWxsIG91dCBzZXRFdmVudExpc3RlbmVycyBtZXRob2RcclxuICAgICAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgICAgICAgLmNvbnRlbnRcclxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAgICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgICAgICAvL2dyYWJiaW5nIG91ciBtYWluIGVsZW1lbnRzIGZvciB0aGUgY2FyZCBhbmQgc2ltcGx5IGdpdmluZyB0aGVtIHRoZWlyIGF0dHJ1YnV0ZXMgbm93IGFzIGFuIG9iamVjdCEgICAgIFxyXG4gICAgICAgIGNvbnN0IGNhcmRUZXh0ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19jYXB0aW9uXCIpO1xyXG4gICAgICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcblxyXG4gICAgICAgIGNhcmRUZXh0LnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgICAgICBjYXJkSW1hZ2Uuc2V0QXR0cmlidXRlKFwiYWx0XCIsIHRoaXMuX25hbWUpO1xyXG4gICAgICAgIGNhcmRJbWFnZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdGhpcy5fbGluayk7XHJcblxyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuXHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICAgIH1cclxufVxyXG4iLCIvL3RoaXMgaXMgZ29ubmEgYmUgb3VyIG9iamVjdCB0byBwYXNzIGlucHV0cyB0aHJvdWdoIGZvciB2YWxpZGF0aW9uXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtKSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgICAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcblxyXG4gICAgICAgIHRoaXMuX2Zvcm0gPSBmb3JtO1xyXG4gICAgfVxyXG5cclxuICAgIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBpbnB1dEVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgICAgIGlucHV0RXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgICAgIGlucHV0RXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgaW5wdXRFcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgICAgICBpbnB1dEVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICAgICAgaW5wdXRFcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xyXG4gICAgICAgIHJldHVybiAhaW5wdXRMaXN0LmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQpO1xyXG4gICAgfVxyXG5cclxuICAgIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcclxuICAgICAgICAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9kaXNhYmxlQnV0dG9uKCl7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsIHRydWUpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcikpO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcblxyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG59XHJcbiIsIlxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihtb2RhbCkge1xyXG4gICAgICAgIHRoaXMuX21vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihtb2RhbCk7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcclxuICAgICAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9wZW4oKSB7XHJcbiAgICAgICAgdGhpcy5fbW9kYWwuY2xhc3NMaXN0LmFkZCgnbW9kYWxfb3BlbmVkJyk7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9tb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdtb2RhbF9vcGVuZWQnKTtcclxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIFxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgY29uc3QgY2xvc2VCdXR0b24gPSB0aGlzLl9tb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19leGl0LWJ1dHRvblwiKTtcclxuICAgICAgICBjbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuX21vZGFsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9tb2RhbC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsX29wZW5lZCcpXHJcbiAgICAgICAgICAgICAgICAmJiBlLnRhcmdldCA9PT0gdGhpcy5fbW9kYWwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3BVcFdpdGhGb3JtIGV4dGVuZHMgUG9wdXB7XHJcbiAgICBjb25zdHJ1Y3Rvcihtb2RhbCwgaGFuZGxlRm9ybVN1Ym1pdCl7XHJcbiAgICAgICAgc3VwZXIobW9kYWwpO1xyXG4gICAgICAgIHRoaXMuX21vZGFsRm9ybSA9IHRoaXMuX21vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fZm9ybScpO1xyXG4gICAgICAgIHRoaXMuX21vZGFsQnV0dG9uID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19idXR0b24nKTtcclxuICAgICAgICB0aGlzLl9tb2RhbEJ1dHRvblRleHQgPSB0aGlzLl9tb2RhbEJ1dHRvbi50ZXh0Q29udGVudDtcclxuICAgICAgICB0aGlzLl9tb2RhbElucHV0cyA9IHRoaXMuX21vZGFsRm9ybS5xdWVyeVNlbGVjdG9yQWxsKCcubW9kYWxfX2lucHV0Jyk7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldElucHV0VmFsdWVzKCl7XHJcbiAgICAgICAgLy90aGlzIHdpbGwgZ2V0IGRhdGEgZnJvbSB0aGUgZmllbGRzIHdpdGggZm9ybXNcclxuICAgICAgICBjb25zdCBfZm9ybURhdGEgPSBuZXcgRm9ybURhdGEodGhpcy5fbW9kYWxGb3JtKTtcclxuICAgICAgICBjb25zdCBfaW5wdXRWYWxzID0gT2JqZWN0LmZyb21FbnRyaWVzKF9mb3JtRGF0YSk7XHJcbiAgICAgICAgcmV0dXJuIF9pbnB1dFZhbHM7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcpe1xyXG4gICAgICAgIGlmKGlzTG9hZGluZyl7XHJcbiAgICAgICAgICAgIHRoaXMuX21vZGFsQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9tb2RhbEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX21vZGFsQnV0dG9uVGV4dDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKXtcclxuICAgICAgICAvL3RoaXMgd2lsbCBtb2RpZnkgdGhlIHBhcmVudCBzZXQgZXZlbnQgbGlzdGVuZXJzIGFuZCBtdXN0IGFkZCBcclxuICAgICAgICAvL3RoZSBzdWJtaXQgZm9ybSBoYW5kbGVyIGFuZCB3ZSBjYWxsIHRoZSBwYXJlbnQgc2V0ZXZlbnRsaXN0ZW5lcnNcclxuICAgICAgICAvL3dlIGNhbiBwdXQgb3VyIHN1Ym1pdCBjb2RlIGluIHRoZSBjYWxsYmFjayBhbmQgaGF2ZSB0aGUgc3VibWl0IGZpcmUgaGVyZVxyXG4gICAgICAgIHRoaXMuX21vZGFsRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCl7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgICAgICB0aGlzLl9tb2RhbEZvcm0ucmVzZXQoKTtcclxuICAgIH1cclxufSIsIi8vaW1wb3J0aW5nIHdoYXQgd2UgbmVlZFxyXG5pbXBvcnQge1xyXG4gICAgZWRpdEJ1dHRvbixcclxuICAgIGFkZEltYWdlQnV0dG9uLFxyXG4gICAgcHJvZmlsZUVkaXRGb3JtLFxyXG4gICAgYWRkSW1hZ2VFZGl0Rm9ybSxcclxuICAgIGVkaXRBdmF0YXJGb3JtLFxyXG4gICAgcHJvZmlsZUVkaXROYW1lSW5wdXQsXHJcbiAgICBwcm9maWxlRWRpdEpvYklucHV0LFxyXG4gICAgZWRpdEF2YXRhckJ1dHRvbixcclxufVxyXG4gICAgZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxuaW1wb3J0IHsgZm9ybUNvbmZpZyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFBvcFVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcFVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3BVcFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcFVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5cclxuLy90ZXNpbmcgdGhlIEFQSVxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICAgIHVybDogJ2h0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxJyxcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiAnYTA4N2RhNTktNmFhMS00ZGJmLThhMmMtOTgyZTk3ZGE2MDgwJyxcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgfSxcclxufSk7XHJcblxyXG4vL2xvYWRpbmcgdXNlciBkYXRhXHJcbmFwaS5nZXRDYXJkc0FuZFVzZXJEYXRhKCkudGhlbigoW2NhcmRzLCB1c2VyXSkgPT4ge1xyXG4gICAgY2FyZHMuZm9yRWFjaCgoY2FyZCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IG5ld0NhcmQgPSBjcmVhdGVDYXJkKHtcclxuICAgICAgICAgICAgbmFtZTogY2FyZC5uYW1lLFxyXG4gICAgICAgICAgICBsaW5rOiBjYXJkLmxpbmssXHJcbiAgICAgICAgICAgIGlkOiBjYXJkLl9pZCxcclxuICAgICAgICAgICAgaXNMaWtlZDogY2FyZC5pc0xpa2VkXHJcbiAgICAgICAgfSlcclxuICAgICAgICBjYXJkTGlzdC5hZGRJdGVtKG5ld0NhcmQpO1xyXG4gICAgfSlcclxuXHJcbiAgICBjb25zdCB7IGF2YXRhciwgYWJvdXQsIG5hbWUgfSA9IHVzZXI7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pO1xyXG4gICAgdXNlckluZm8uc2V0QXZhdGFyKGF2YXRhcik7XHJcbn0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcblxyXG4vL21vZGFsIHJlbGF0ZWQgY29kZSBhbmQgcmVzcGVjdGl2ZSBjYWxsYmFja3NcclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oJyN1c2VyLW5hbWUnLCAnI3VzZXItY2FyZWVyJywgJy5wcm9maWxlX19hdmF0YXInKTtcclxuXHJcbmNvbnN0IGVubGFyZ2VJbWFnZU1vZGFsID0gbmV3IFBvcFVwV2l0aEltYWdlKCcjZW5sYXJnZWQtbW9kYWwtYm94Jyk7XHJcblxyXG5jb25zdCBjb25maXJtYXRpb25Nb2RhbCA9IG5ldyBQb3BVcFdpdGhDb25maXJtYXRpb24oJyNjb25maXJtLW1vZGFsJyk7XHJcblxyXG5jb25zdCBlZGl0QXZhdGFyTW9kYWwgPSBuZXcgUG9wVXBXaXRoRm9ybSgnI2F2YXRhci1lZGl0LW1vZGFsJywgKGRhdGEpID0+IHtcclxuICAgIGVkaXRBdmF0YXJNb2RhbC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gICAgYXBpLnVwZGF0ZVByb2ZpbGVQaWMoZGF0YVtcImF2YXRhci1saW5rXCJdKVxyXG4gICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgIHVzZXJJbmZvLnNldEF2YXRhcihyZXMuYXZhdGFyKTtcclxuICAgICAgICAgICAgZWRpdEF2YXRhck1vZGFsLmNsb3NlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZmluYWxseSgoKSA9PiBlZGl0QXZhdGFyTW9kYWwucmVuZGVyTG9hZGluZyhmYWxzZSkpXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG59KTtcclxuXHJcbmNvbnN0IGFkZEltYWdlTW9kYWwgPSBuZXcgUG9wVXBXaXRoRm9ybShcIiNhZGQtbW9kYWwtYm94XCIsIChkYXRhKSA9PiB7XHJcbiAgICBhZGRJbWFnZU1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgICBhcGkudXBsb2FkQ2FyZChkYXRhW1wiYWRkLWltZy10aXRsZVwiXSwgZGF0YVtcImFkZC1pbWctbGlua1wiXSlcclxuICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgbmFtZSwgbGluaywgX2lkLCBpc0xpa2VkIH0gPSByZXM7XHJcbiAgICAgICAgICAgIGNhcmRMaXN0LnByZXBlbmRJdGVtKGNyZWF0ZUNhcmQoe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICAgICAgICAgIGxpbms6IGxpbmssXHJcbiAgICAgICAgICAgICAgICBpZDogX2lkLFxyXG4gICAgICAgICAgICAgICAgaXNMaWtlZDogaXNMaWtlZFxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIGFkZEltYWdlTW9kYWwuY2xvc2UoKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4gYWRkSW1hZ2VNb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbn0pO1xyXG5cclxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IG5ldyBQb3BVcFdpdGhGb3JtKFwiI3Byb2ZpbGUtbW9kYWwtYm94XCIsIChkYXRhKSA9PiB7XHJcbiAgICBlZGl0UHJvZmlsZU1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgICBhcGkuc2V0UHJvZmlsZURhdGFcclxuICAgICAgICAoZGF0YVtcInByb2ZpbGUtbW9kYWwtdXNlcm5hbWVcIl0sIGRhdGFbXCJwcm9maWxlLW1vZGFsLWRlc2NcIl0pXHJcbiAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzKTtcclxuICAgICAgICAgICAgZWRpdFByb2ZpbGVNb2RhbC5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4gZWRpdFByb2ZpbGVNb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbn0pO1xyXG5cclxuLy9mdW5jdGlvbnNcclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChpdGVtKSB7XHJcbiAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoaXRlbSwgXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgZW5sYXJnZUltYWdlTW9kYWwub3BlbihpdGVtLm5hbWUsIGl0ZW0ubGluaylcclxuICAgICAgICB9LFxyXG4gICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgY29uZmlybWF0aW9uTW9kYWwub3BlbigpO1xyXG4gICAgICAgICAgICBjb25maXJtYXRpb25Nb2RhbC5zZXRBY3Rpb24oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uZmlybWF0aW9uTW9kYWwucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICAgICAgICAgICAgICAgIGFwaS5kZWxldGVDYXJkKGNhcmQuX2lkKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FyZC5kZWxldGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybWF0aW9uTW9kYWwuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KS5maW5hbGx5KCgpID0+IGNvbmZpcm1hdGlvbk1vZGFsLnJlbmRlckxvYWRpbmcoZmFsc2UpKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG4gICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgaWYgKGNhcmQuaXNMaWtlZCgpKSB7XHJcbiAgICAgICAgICAgICAgICBhcGkudW5saWtlQ2FyZChjYXJkLl9pZClcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4gY2FyZC5zZXRJc0xpa2VkKHJlcy5pc0xpa2VkKSlcclxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhcGkubGlrZUNhcmQoY2FyZC5faWQpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IGNhcmQuc2V0SXNMaWtlZChyZXMuaXNMaWtlZCkpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG59XHJcblxyXG4vL2NhcmQgcmVuZGVyaW5nIHNlY3Rpb24gYW5kIHJlbmRlcmluZ1xyXG5jb25zdCBjYXJkTGlzdCA9IG5ldyBTZWN0aW9uKHtcclxuICAgIGl0ZW1zOiBbXSxcclxuICAgIHJlbmRlcmVyOiAoKSA9PiB7IH1cclxufSwgJy5jYXJkcycpO1xyXG5cclxuY2FyZExpc3QucmVuZGVySXRlbXMoKTtcclxuXHJcbi8vZW5hYmxpbmcgZm9ybSB2YWxpZGF0aW9uXHJcbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBhZGRJbWFnZUVkaXRGb3JtKTtcclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBwcm9maWxlRWRpdEZvcm0pO1xyXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybUNvbmZpZywgZWRpdEF2YXRhckZvcm0pO1xyXG5cclxuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vL3NlY3Rpb24gZm9yIGV2ZW50IGhhbmRsZXJzXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGVkaXRQcm9maWxlTW9kYWwub3BlbigpO1xyXG4gICAgY29uc3QgeyBuYW1lLCBqb2IgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgICBwcm9maWxlRWRpdE5hbWVJbnB1dC52YWx1ZSA9IG5hbWU7XHJcbiAgICBwcm9maWxlRWRpdEpvYklucHV0LnZhbHVlID0gam9iO1xyXG59KTtcclxuXHJcbmFkZEltYWdlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBhZGRJbWFnZU1vZGFsLm9wZW4oKTtcclxufSk7XHJcblxyXG5lZGl0QXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBlZGl0QXZhdGFyTW9kYWwub3BlbigpO1xyXG59KTtcclxuXHJcbmVkaXRQcm9maWxlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuYWRkSW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5lbmxhcmdlSW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5jb25maXJtYXRpb25Nb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5lZGl0QXZhdGFyTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLl91cmwgPSBvcHRpb25zLnVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfcHJvY2Vzc1Jlc3BvbnNlID0gKHJlcykgPT4ge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGdldFVzZXJEYXRhKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX3VybCArICcvdXNlcnMvbWUnLCB7XHJcbiAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX3VybCArICcvY2FyZHMnLCB7XHJcbiAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgdXBsb2FkQ2FyZChuYW1lLCBsaW5rKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fdXJsICsgJy9jYXJkcycsIHtcclxuICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGxpbms6IGxpbmtcclxuICAgICAgfSlcclxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaCh0aGlzLl91cmwgKyBgL2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgfSkudGhlbih0aGlzLl9wcm9jZXNzUmVzcG9uc2UpXHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRDYXJkc0FuZFVzZXJEYXRhKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJEYXRhKCldKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgLy90aGlzIHdpbGwgYmUgb3V0IG1ldGhvZCB0byBoYXZlIGxpa2VzIGluIGEgY2FyZFxyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX3VybCArIGAvY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSlcclxuICB9XHJcblxyXG4gIGFzeW5jIHVubGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fdXJsICsgYC9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKVxyXG4gIH1cclxuXHJcbiAgLy8gb3RoZXIgbWV0aG9kcyBmb3Igd29ya2luZyB3aXRoIHRoZSBBUElcclxuICBhc3luYyBzZXRQcm9maWxlRGF0YShuYW1lLCBhYm91dCkge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX3VybCArICcvdXNlcnMvbWUnLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGFib3V0XHJcbiAgICAgIH0pXHJcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSlcclxuICB9XHJcblxyXG4gIGFzeW5jIHVwZGF0ZVByb2ZpbGVQaWModXJsKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fdXJsICsgJy91c2Vycy9tZS9hdmF0YXInLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogdXJsXHJcbiAgICAgIH0pXHJcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSlcclxuICB9XHJcbn1cclxuXHJcbi8vd2Ugd2lsbCBuZWVkIHRvIGZpbmQgYSB3YXkgdG8gaGF2ZSB0aGUgcmVzcGVjdGl2ZSBwb3B1cHMgaGF2ZSBhIGxvYWRpbmcgcGhhc2UuLnRoZXJlIGlzIGEgcmVzb3VyY2UgaW4gdGhlIGxlc3NvbnMgSSBjYW4gYWN0dWFsbHkgdXNlXHJcbi8vd2Ugd2lsbCBhZGQgYSBuZXcgbGl0dGxlIGVsZW1lbnQgaW4gdGhlIGNhcmQgb2JqZWN0IHRvIHNob3cgdGhlIGxpa2VzIGFzIGFuIGludGVnZXIiLCJcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm97XHJcbiAgICBjb25zdHJ1Y3RvcihuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3Rvcil7XHJcbiAgICAgICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fam9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX2F2YXRhckltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VXNlckluZm8oKXtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgICAgICAgICAgam9iOiB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW5mbyhpbmZvKXtcclxuICAgICAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IGluZm8ubmFtZTtcclxuICAgICAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gaW5mby5hYm91dDtcclxuICAgIH1cclxuXHJcbiAgICBzZXRBdmF0YXIoYXZhdGFyTGluayl7XHJcbiAgICAgICAgdGhpcy5fYXZhdGFySW1hZ2Uuc3JjID0gYXZhdGFyTGluaztcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wVXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cHtcclxuICAgIGNvbnN0cnVjdG9yKG1vZGFsKXtcclxuICAgICAgIHN1cGVyKG1vZGFsKTtcclxuICAgICAgIHRoaXMuX21vZGFsSW1hZ2UgPSB0aGlzLl9tb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2VubGFyZ2VkLWltYWdlJyk7XHJcbiAgICAgICB0aGlzLl9tb2RhbENhcHRpb24gPSB0aGlzLl9tb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2VubGFyZ2VkLXRleHQnKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKG5hbWUsIGxpbmspe1xyXG4gICAgICAgIHRoaXMuX21vZGFsSW1hZ2Uuc2V0QXR0cmlidXRlKCdzcmMnLCBsaW5rKTtcclxuICAgICAgICB0aGlzLl9tb2RhbEltYWdlLnNldEF0dHJpYnV0ZSgnYWx0JywgbmFtZSk7XHJcbiAgICAgICAgdGhpcy5fbW9kYWxDYXB0aW9uLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgICAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwe1xyXG4gICAgY29uc3RydWN0b3IobW9kYWwpe1xyXG4gICAgICAgIHN1cGVyKG1vZGFsKTtcclxuICAgICAgICB0aGlzLl9tb2RhbEZvcm0gPSB0aGlzLl9tb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Zvcm0nKTtcclxuICAgICAgICB0aGlzLl9tb2RhbEJ1dHRvbiA9IHRoaXMuX21vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fYnV0dG9uJyk7XHJcbiAgICAgICAgdGhpcy5fbW9kYWxCdXR0b25UZXh0ID0gdGhpcy5fbW9kYWxCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0QWN0aW9uKGFjdGlvbil7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGFjdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZyl7XHJcbiAgICAgICAgaWYoaXNMb2FkaW5nKXtcclxuICAgICAgICAgICAgdGhpcy5fbW9kYWxCdXR0b24udGV4dENvbnRlbnQgPSBcIkRlbGV0aW5nLi4uXCI7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fbW9kYWxCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9tb2RhbEJ1dHRvblRleHQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCl7XHJcbiAgICAgICAgdGhpcy5fbW9kYWxGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcblxyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJlcGVuZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZW5kZXJJdGVtcygpIHtcclxuICAgICAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0iXSwibmFtZXMiOlsiZm9ybUNvbmZpZyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiZWRpdEJ1dHRvbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEltYWdlQnV0dG9uIiwicHJvZmlsZUVkaXRGb3JtIiwiYWRkSW1hZ2VFZGl0Rm9ybSIsImVkaXRBdmF0YXJGb3JtIiwicHJvZmlsZUVkaXROYW1lSW5wdXQiLCJwcm9maWxlRWRpdEpvYklucHV0IiwiZWRpdEF2YXRhckJ1dHRvbiIsIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVDYXJkRGVsZXRlIiwiaGFuZGxlQ2FyZExpa2UiLCJuYW1lIiwibGluayIsImlkIiwiaXNMaWtlZCIsInRoaXMiLCJfbmFtZSIsIl9saW5rIiwiX2lkIiwiX2lzTGlrZWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVEZWxldGVDYXJkIiwiX2hhbmRsZUNhcmRMaWtlIiwiX3JlbmRlckxpa2VzIiwibGlrZUJ1dHRvbiIsIl9jYXJkRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsIl9zZXRFdmVudExpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJzZXRJc0xpa2VkIiwiZGVsZXRlIiwiZ2VuZXJhdGVDYXJkIiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmRUZXh0IiwiY2FyZEltYWdlIiwidGV4dENvbnRlbnQiLCJzZXRBdHRyaWJ1dGUiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtIiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsIl9mb3JtIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiaW5wdXRFcnJvckVsZW1lbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsImlucHV0TGlzdCIsImV2ZXJ5IiwiaW5wdXQiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfaW5wdXRMaXN0IiwiX2Rpc2FibGVCdXR0b24iLCJfYnV0dG9uRWxlbWVudCIsInJlbW92ZUF0dHJpYnV0ZSIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZSIsInByZXZlbnREZWZhdWx0IiwiZW5hYmxlVmFsaWRhdGlvbiIsIlBvcHVwIiwibW9kYWwiLCJfbW9kYWwiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwiZXZ0Iiwia2V5IiwiY2xvc2UiLCJvcGVuIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwiY29udGFpbnMiLCJ0YXJnZXQiLCJQb3BVcFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX21vZGFsRm9ybSIsIl9tb2RhbEJ1dHRvbiIsIl9tb2RhbEJ1dHRvblRleHQiLCJfbW9kYWxJbnB1dHMiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsIl9mb3JtRGF0YSIsIkZvcm1EYXRhIiwiT2JqZWN0IiwiZnJvbUVudHJpZXMiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwicmVzZXQiLCJhcGkiLCJvcHRpb25zIiwiX3VybCIsInVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsIl9wcm9jZXNzUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckRhdGEiLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJnZXRJbml0aWFsQ2FyZHMiLCJ1cGxvYWRDYXJkIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwiZ2V0Q2FyZHNBbmRVc2VyRGF0YSIsImFsbCIsImxpa2VDYXJkIiwidW5saWtlQ2FyZCIsInNldFByb2ZpbGVEYXRhIiwiYWJvdXQiLCJ1cGRhdGVQcm9maWxlUGljIiwiYXZhdGFyIiwiYXV0aG9yaXphdGlvbiIsImNhcmRzIiwidXNlciIsImNhcmQiLCJuZXdDYXJkIiwiY3JlYXRlQ2FyZCIsImNhcmRMaXN0IiwiYWRkSXRlbSIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJzZXRBdmF0YXIiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJfYXZhdGFySW1hZ2UiLCJnZXRVc2VySW5mbyIsImpvYiIsImluZm8iLCJhdmF0YXJMaW5rIiwic3JjIiwiZW5sYXJnZUltYWdlTW9kYWwiLCJfbW9kYWxJbWFnZSIsIl9tb2RhbENhcHRpb24iLCJjb25maXJtYXRpb25Nb2RhbCIsInNldEFjdGlvbiIsImFjdGlvbiIsImVkaXRBdmF0YXJNb2RhbCIsImRhdGEiLCJmaW5hbGx5IiwiYWRkSW1hZ2VNb2RhbCIsInByZXBlbmRJdGVtIiwiZWRpdFByb2ZpbGVNb2RhbCIsIml0ZW0iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiZWxlbWVudCIsImFwcGVuZCIsInByZXBlbmQiLCJyZW5kZXJJdGVtcyIsImFkZEZvcm1WYWxpZGF0b3IiLCJlZGl0Rm9ybVZhbGlkYXRvciIsImF2YXRhckZvcm1WYWxpZGF0b3IiLCJ2YWx1ZSJdLCJzb3VyY2VSb290IjoiIn0=